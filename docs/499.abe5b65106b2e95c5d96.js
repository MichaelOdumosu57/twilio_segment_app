"use strict";(self.webpackChunkangular_app=self.webpackChunkangular_app||[]).push([[499],{499:(et,g,o)=>{o.r(g),o.d(g,{HomeModule:()=>q});var L=o(274),v=o(979),h=o(887),R=o(582),B=o(948),U=o(622),F=o(673),P=o(561);function x(t,n,e,s){return(0,F.m)(e)&&(s=e,e=void 0),s?x(t,n,e).pipe((0,P.U)(r=>(0,U.k)(r)?s(...r):s(r))):new B.y(r=>{M(t,n,function(i){r.next(arguments.length>1?Array.prototype.slice.call(arguments):i)},r,e)})}function M(t,n,e,s,r){let a;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){const i=t;t.addEventListener(n,e,r),a=()=>i.removeEventListener(n,e,r)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){const i=t;t.on(n,e),a=()=>i.off(n,e)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){const i=t;t.addListener(n,e),a=()=>i.removeListener(n,e)}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(let i=0,l=t.length;i<l;i++)M(t[i],n,e,s,r)}s.add(a)}var J=o(267),d=o(917),p=o(286),V=o(214),k=o(744);class D{constructor(n,e){this.count=n,this.source=e}call(n,e){return e.subscribe(new G(n,this.count,this.source))}}class G extends k.L{constructor(n,e,s){super(n),this.count=e,this.source=s}error(n){if(!this.isStopped){const{source:e,count:s}=this;if(0===s)return super.error(n);s>-1&&(this.count=s-1),e.subscribe(this._unsubscribeAndRecycle())}}}var Y=o(974);class w{constructor(n,e){this.count=n,this.source=e}call(n,e){return e.subscribe(new X(n,this.count,this.source))}}class X extends k.L{constructor(n,e,s){super(n),this.count=e,this.source=s}complete(){if(!this.isStopped){const{source:n,count:e}=this;if(0===e)return super.complete();e>-1&&(this.count=e-1),n.subscribe(this._unsubscribeAndRecycle())}}}var W=o(72),y=o(766),c=o(606),$=o(45);const N=["homeMap"],O=[{path:"",component:(()=>{class t{constructor(e,s){this.ryber=e,this.ref=s,this.myClass="a_p_p_HomeView",this.subs=[],this.state={current:"busy",obs:new R.xQ,reset:()=>{let{free:r,busy:a,pastTime:i,ref:l}=this;r.button.style={},r.text.style={},a.button.style={},a.text.style={},i.button.style={},i.text.style={},l.detectChanges()}},this.free={button:{style:{},click:r=>{let{http:a}=this.ryber;a.post(y.N.backend.url,{env:"main",type:"free"}).pipe((0,d.q)(1),(0,p.b)(i=>{if(!(i instanceof h.UA)){let{state:l}=this;l.reset(),l.current="free",l.obs.next({})}})).subscribe()}},text:{style:{}}},this.busy={button:{style:{},click:r=>{let{http:a}=this.ryber;a.post(y.N.backend.url,{env:"main",type:"busy"}).pipe((0,d.q)(1),(0,p.b)(i=>{if(!(i instanceof h.UA)){let{state:l}=this;l.reset(),l.current="busy",l.obs.next({})}})).subscribe()}},text:{style:{}}},this.pastTime={button:{style:{},click:r=>{let{http:i}=this.ryber;i.post(y.N.backend.url,{env:"main",type:"pastTime"}).pipe((0,d.q)(1),(0,p.b)(l=>{if(!(l instanceof h.UA)){let{state:u}=this;u.reset(),u.current="pastTime",u.obs.next({})}})).subscribe()}},text:{style:{}}}}ngAfterViewInit(){let A,{free:e,busy:s,pastTime:r,state:a,ref:i,subs:l,ryber:u,myHomeMap:E}=this,C="radial-gradient(farthest-corner at 100% 0px,  tan 0%, brown 120%)",H="radial-gradient(farthest-corner at 100% 0px, yellow 0%, green 200%)",T="radial-gradient(farthest-corner at 100% 0px, violet 0%, purple 200%)",_=a.obs.pipe((0,p.b)(()=>{switch(a.current){case"free":e.button.style={background:"white","border-radius":C},e.text.style={background:C,"-webkit-background-clip":"text","-webkit-text-fill-color":"transparent"};break;case"busy":s.button.style={background:"white","border-radius":H},s.text.style={background:H,"-webkit-background-clip":"text","-webkit-text-fill-color":"transparent"};break;case"pastTime":r.button.style={background:"white","border-radius":T},r.text.style={background:T,"-webkit-background-clip":"text","-webkit-text-fill-color":"transparent"}}i.detectChanges()})).subscribe();a.obs.next({}),l.push(_),window.google?(console.log("loaded"),u.googleMaps.setup({map:E})):(A=x(u.googleMaps.script.element,"load").pipe((0,p.b)(f=>{u.googleMaps.setup({map:E})})).subscribe(),l.push(A));let tt=u.http.get(y.N.backend.url+"/direction",{responseType:"text"}).pipe((0,V.g)(1e3),function(t=-1){return n=>n.lift(new D(t,n))}(20),function(t=-1){return n=>0===t?(0,Y.c)():n.lift(new w(t<0?-1:t-1,n))}(1/0),(0,p.b)(f=>{let S=u.googleMaps.marker.getPosition(),b=S.lat(),m=S.lng();switch("waiting"!==f&&analytics.track(f),f){case"up":b+=5e-4;break;case"down":b-=5e-4;break;case"left":m-=5e-4;break;case"right":m+=5e-4}u.googleMaps.marker.setPosition({lat:b,lng:m})}),(0,W.K)(f=>(alert("There seems to be any issue with the app try again later"),(0,J.of)({})))).subscribe();l.push(tt)}ngOnDestroy(){this.subs.forEach((e,s)=>{e.unsubscribe()})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36($.p),c.Y36(c.sBO))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-main"]],viewQuery:function(e,s){if(1&e&&c.Gf(N,5),2&e){let r;c.iGM(r=c.CRH())&&(s.myHomeMap=r.first)}},hostVars:2,hostBindings:function(e,s){2&e&&c.Tol(s.myClass)},decls:3,vars:0,consts:[[1,"a_p_p_HomePod0"],[1,"a_p_p_HomePod0Map"],["homeMap",""]],template:function(e,s){1&e&&(c.TgZ(0,"div",0),c._UZ(1,"div",1,2),c.qZA())},encapsulation:2,changeDetection:0}),t})()}];let j=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[v.Bz.forChild(O)],v.Bz]}),t})(),q=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[L.ez,j]]}),t})()}}]);